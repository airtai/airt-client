
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python client for airt-service">
      
      
        <meta name="author" content="airt.ai">
      
      
        <link rel="canonical" href="https://airtai.github.io/airt-client/API_Client/">
      
      
      
      <link rel="icon" href="../overrides/images/airt_icon_blue.svg">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>API_Client - airt</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../overrides/css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-H6EV08GRK5"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-H6EV08GRK5",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-H6EV08GRK5",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  
  
    
  
  
  <meta property="og:type" content="website" />
  <meta property="og:title" content="airt - API_Client" />
  <meta property="og:description" content="Python client for airt-service" />
  <meta property="og:url" content="https://airtai.github.io/airt-client/API_Client/" />
  <meta property="og:image" content="https://opengraph.githubassets.com/1671820337.584456/airtai/airt-client" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="airt - API_Client" />
  <meta name="twitter:description" content="Python client for airt-service" />
  <meta name="twitter:image" content="https://opengraph.githubassets.com/1671820337.584456/airtai/airt-client" />

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api_client" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="airt" class="md-header__button md-logo" aria-label="airt" data-md-component="logo">
      
  <img src="../overrides/images/airt_icon_blue.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            airt
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API_Client
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/airtai/airt-client" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    airt-client
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="airt" class="md-nav__button md-logo" aria-label="airt" data-md-component="logo">
      
  <img src="../overrides/images/airt_icon_blue.svg" alt="logo">

    </a>
    airt
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/airtai/airt-client" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    airt-client
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Python client for airt service
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../airt_api_docs/airt/client/" class="md-nav__link">
        airt.client
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          CLI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          CLI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../airt_cli_docs/airt/" class="md-nav__link">
        airt
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#client" class="md-nav__link">
    Client
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="api_client">API_Client<a class="headerlink" href="#api_client" title="Permanent link">¤</a></h1>
<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

<p>Note:</p>
<p>While writing doc strings, please use the below syntax for linking
methods/classes. So that the methods/classes gets highlighted in the
browser and clicking on it will take the user to the linked function</p>
<div class="highlight"><pre><span></span><code>- To link a method from the class same file please use the `method_name` format.
- To link a method from a different Class (can in a seperate file also) please use `Classname.method_name` format.
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">airt._testing</span> <span class="kn">import</span> <span class="n">activate_by_import</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[INFO] airt.testing.activate_by_import: Testing environment activated.
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>

<span class="kn">import</span> <span class="nn">pytest</span>

<span class="kn">import</span> <span class="nn">airt._sanitizer</span>
<span class="kn">from</span> <span class="nn">airt._components.user</span> <span class="kn">import</span> <span class="n">User</span>
<span class="kn">from</span> <span class="nn">airt._constant</span> <span class="kn">import</span> <span class="n">SERVICE_PASSWORD</span><span class="p">,</span> <span class="n">SERVICE_SUPER_USER</span><span class="p">,</span> <span class="n">SERVICE_USERNAME</span>
<span class="kn">from</span> <span class="nn">airt._docstring.helpers</span> <span class="kn">import</span> <span class="n">run_examples_from_docstring</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">display</span><span class="p">(</span><span class="n">logger</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">logger</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">()</span> <span class="o">==</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>

<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;This is a debug message&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;This is an info&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;This is a warning&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;This is an error&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>20

[INFO] __main__: This is an info
[WARNING] __main__: This is a warning
[ERROR] __main__: This is an error
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mask</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="k">assert</span> <span class="n">mask</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;****&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;fake_username&quot;</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;fake_password&quot;</span>

<span class="n">expected</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fake_username&quot;</span><span class="p">,</span> <span class="s2">&quot;fake_password&quot;</span><span class="p">)</span>

<span class="n">actual</span> <span class="o">=</span> <span class="n">_get_credentials</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">actual</span> <span class="o">==</span> <span class="n">expected</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>(&#39;fake_username&#39;, &#39;fake_password&#39;)
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Assign env vars to temp variables and delete the env vars</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVICE_USERNAME</span><span class="p">):</span>
    <span class="n">airt_service_username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVICE_USERNAME</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_USERNAME</span><span class="p">]</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVICE_PASSWORD</span><span class="p">):</span>
    <span class="n">airt_service_password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVICE_PASSWORD</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_PASSWORD</span><span class="p">]</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">_get_credentials</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&#39;The username and password are neither passed as parameters nor set in the environment variables `</span><span class="si">{</span><span class="n">SERVICE_USERNAME</span><span class="si">}</span><span class="s2">` and `</span><span class="si">{</span><span class="n">SERVICE_PASSWORD</span><span class="si">}</span><span class="s2">`.&#39;&quot;</span>
    <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;e.value=KeyError(&#39;The username and password are neither passed as parameters nor set in the environment variables `AIRT_SERVICE_USERNAME` and `AIRT_SERVICE_PASSWORD`.&#39;)&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Assign only username in env var</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_USERNAME</span><span class="p">]</span> <span class="o">=</span> <span class="n">airt_service_username</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">_get_credentials</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&#39;The password is neither passed as parameter nor set in the environment variable </span><span class="si">{</span><span class="n">SERVICE_PASSWORD</span><span class="si">}</span><span class="s2">.&#39;&quot;</span>
    <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;e.value=KeyError(&#39;The password is neither passed as parameter nor set in the environment variable AIRT_SERVICE_PASSWORD.&#39;)&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># assign airt_service_password in env var</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_PASSWORD</span><span class="p">]</span> <span class="o">=</span> <span class="n">airt_service_password</span>

<span class="c1"># deleting airt_service_username in env var</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVICE_USERNAME</span><span class="p">):</span>
    <span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_USERNAME</span><span class="p">]</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">_get_credentials</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&#39;The username is neither passed as parameter nor set in the environment variable </span><span class="si">{</span><span class="n">SERVICE_USERNAME</span><span class="si">}</span><span class="s2">.&#39;&quot;</span>
    <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># resetting the username and password env variables</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_USERNAME</span><span class="p">]</span> <span class="o">=</span> <span class="n">airt_service_username</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_USERNAME</span><span class="p">]</span> <span class="o">==</span> <span class="n">airt_service_username</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_PASSWORD</span><span class="p">]</span> <span class="o">==</span> <span class="n">airt_service_password</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;e.value=KeyError(&#39;The username is neither passed as parameter nor set in the environment variable AIRT_SERVICE_USERNAME.&#39;)&quot;
</code></pre></div>
<hr />
<p><a
href="https://github.com/airtai/airt-client/blob/main/airt/_components/client.py#L76"
target="_blank" style="float:right; font-size:smaller">source</a></p>
<h3 id="client">Client<a class="headerlink" href="#client" title="Permanent link">¤</a></h3>
<blockquote>
<div class="highlight"><pre><span></span><code> Client (server:str, auth_token:str,
         sso_authorization_url:Optional[str]=None)
</code></pre></div>
</blockquote>
<p>A class for authenticating and accessing the airt service.</p>
<p>To access the airt service, you must first create a developer account.
To obtain one, please contact us at <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#105;&#110;&#102;&#111;&#64;&#97;&#105;&#114;&#116;&#46;&#97;&#105;">&#105;&#110;&#102;&#111;&#64;&#97;&#105;&#114;&#116;&#46;&#97;&#105;</a>.</p>
<p>After successful verification, you will receive an email with the
username and password for the developer account.</p>
<p>Once you have the credentials, use them to get an access token by
calling <code>get_token</code> method. It is necessary to get an access token;
otherwise, you won’t be able to access all of the airt service’s APIs.
You can either pass the username, password, and server address as
parameters to the <code>get_token</code> method or store them in the environment
variables <strong>AIRT_SERVICE_USERNAME</strong>, <strong>AIRT_SERVICE_PASSWORD</strong>, and
<strong>AIRT_SERVER_URL</strong>.</p>
<p>In addition to the regular authentication with credentials, you can also
enable multi-factor authentication (MFA) and single sign-on (SSO) for
generating tokens.</p>
<p>To help protect your account, we recommend that you enable multi-factor
authentication (MFA). MFA provides additional security by requiring you
to provide unique verification code (OTP) in addition to your regular
sign-in credentials when performing critical operations.</p>
<p>Your account can be configured for MFA in just two easy steps:</p>
<ol>
<li>
<p>To begin, you need to enable MFA for your account by calling the
    <a href="https://airtai.github.io/airt-client/api_user.html#user.enable_mfa"><code>User.enable_mfa</code></a>
    method, which will generate a QR code. You can then scan the QR code
    with an authenticator app, such as Google Authenticator and follow
    the on-device instructions to finish the setup in your smartphone.</p>
</li>
<li>
<p>Finally, activate MFA for your account by calling
    <a href="https://airtai.github.io/airt-client/api_user.html#user.activate_mfa"><code>User.activate_mfa</code></a>
    and passing the dynamically generated six-digit verification code
    from your smartphone’s authenticator app.</p>
</li>
</ol>
<p>After activating MFA for your account, you must pass the dynamically
generated six-digit verification code, along with your username and
password, to the <code>get_token</code> method to generate new tokens.</p>
<p>Single sign-on (SSO) can be enabled for your account in three simple
steps:</p>
<ol>
<li>
<p>Enable the SSO for a provider by calling the
    <a href="https://airtai.github.io/airt-client/api_user.html#user.enable_sso"><code>User.enable_sso</code></a>
    method with the SSO provider name and an email address. At the
    moment, we only support <strong>“google”</strong> and <strong>“github”</strong> as SSO
    providers. We intend to support additional SSO providers in future
    releases.</p>
</li>
<li>
<p>Before you can start generating new tokens with SSO, you must first
    authenticate with the SSO provider. Call the <code>get_token</code> with the
    same SSO provider you have enabled in the step above to generate an
    SSO authorization URL. Please copy and paste it into your preferred
    browser and complete the authentication process with the SSO
    provider.</p>
</li>
<li>
<p>After successfully authenticating with the SSO provider, call the
    <code>set_sso_token</code> method to generate a new token and use it
    automatically in all future interactions with the airt server.</p>
</li>
</ol>
<p>Here’s an example of how to use the Client class to authenticate and
display the details of the currently logged-in user.</p>
<p>Example: ```python # Importing necessary libraries from airt.client
import Client, User</p>
<div class="highlight"><pre><span></span><code># Authenticate
# MFA enabled users must pass the OTP along with the username and password
# to the get_token method.
Client.get_token(username=&quot;{fill in username}&quot;, password=&quot;{fill in password}&quot;)

# Print the logged-in user details
print(User.details())
```
</code></pre></div>
<p>``` python</p>
<h1 id="run-example-for-client">Run example for Client<a class="headerlink" href="#run-example-for-client" title="Permanent link">¤</a></h1>
<p>username = os.environ[SERVICE_USERNAME]
password = os.environ[SERVICE_PASSWORD]</p>
<p>run_examples_from_docstring(
    Client,
    username=username,
    password=password,
)
<div class="highlight"><pre><span></span><code>&lt;pre style=&quot;white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,&#39;DejaVu Sans Mono&#39;,consolas,&#39;Courier New&#39;,monospace&quot;&gt;╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Example:                                                                                                        │
│                                                                                                                 │
│     # Importing necessary libraries                                                                             │
│     from  airt.client import Client, User                                                                       │
│                                                                                                                 │
│     # Authenticate                                                                                              │
│     # MFA enabled users must pass the OTP along with the username and password                                  │
│     # to the get_token method.                                                                                  │
│     Client.get_token(username=&quot;{fill in username}&quot;, password=&quot;{fill in password}&quot;)                              │
│                                                                                                                 │
│     # Print the logged-in user details                                                                          │
│     print(User.details())                                                                                       │
│                                                                                                                 │
│ ╭────────────────────────────────────────────────── stdout ───────────────────────────────────────────────────╮ │
│ │ {&#39;username&#39;: &#39;johndoe&#39;, &#39;first_name&#39;: &#39;John&#39;, &#39;last_name&#39;: &#39;Doe&#39;, &#39;email&#39;: &#39;johndoe@airt.ai&#39;,               │ │
│ │ &#39;subscription_type&#39;: &#39;small&#39;, &#39;super_user&#39;: False, &#39;phone_number&#39;: None, &#39;uuid&#39;:                            │ │
│ │ &#39;7363f72b-7ebb-425c-832f-99c42fb7a016&#39;, &#39;disabled&#39;: False, &#39;created&#39;: &#39;2022-10-27T04:39:16&#39;,                │ │
│ │ &#39;is_phone_number_verified&#39;: False, &#39;is_mfa_active&#39;: False}                                                  │ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
│ ╭────────────────────────────────────────────────── stderr ───────────────────────────────────────────────────╮ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
&lt;/pre&gt;

``` python
# Run example for Client.get_token
# The below example will throw Incorrect username or password, thats expected because
# if we send valid username and password, the sms will be sent to the passed phone number.
# We don&#39;t want to send the SMS each time we run the tests

username = os.environ[SERVICE_USERNAME]
password = os.environ[SERVICE_PASSWORD]
with pytest.raises(RuntimeError) as e:
    run_examples_from_docstring(
        Client.get_token,
        username=&quot;invalid_username&quot;,
        password=&quot;invalid_username&quot;,
        otp=&quot;000000&quot;,
        supress_stderr=True,
    )
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>&lt;module&gt;:15: No type or annotation for parameter &#39;username&#39;
&lt;module&gt;:17: No type or annotation for parameter &#39;password&#39;
&lt;module&gt;:19: No type or annotation for parameter &#39;server&#39;
&lt;module&gt;:23: No type or annotation for parameter &#39;sso_provider&#39;
&lt;module&gt;:25: No type or annotation for parameter &#39;otp&#39;
&lt;module&gt;:28: No type or annotation for returned value 1
Failed to parse annotation from &#39;Name&#39; node: &#39;NoneType&#39; object has no attribute &#39;resolve&#39;
Failed to parse annotation from &#39;Name&#39; node: &#39;NoneType&#39; object has no attribute &#39;resolve&#39;
Failed to parse annotation from &#39;Name&#39; node: &#39;NoneType&#39; object has no attribute &#39;resolve&#39;
&lt;module&gt;:34: Failed to get &#39;exception: description&#39; pair from &#39;&#39;
</code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Example:                                                                                                        │
│                                                                                                                 │
│     # Importing necessary libraries                                                                             │
│     from  airt.client import User, Client                                                                       │
│                                                                                                                 │
│     # Authenticate                                                                                              │
│     Client.get_token(username="{fill in username}", password="{fill in password}")                              │
│                                                                                                                 │
│     # Print the logged-in user details                                                                          │
│     print(User.details())                                                                                       │
│                                                                                                                 │
│ ╭────────────────────────────────────────────────── stdout ───────────────────────────────────────────────────╮ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
│ ╭───────────────────────────────────────────── stderr supressed ──────────────────────────────────────────────╮ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
</pre>

<div class="highlight"><pre><span></span><code><span class="c1"># Run example for Client.set_sso_token</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">run_examples_from_docstring</span><span class="p">(</span>
        <span class="n">Client</span><span class="o">.</span><span class="n">set_sso_token</span><span class="p">,</span>
        <span class="n">username</span><span class="o">=</span><span class="s2">&quot;invalid_username&quot;</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="s2">&quot;invalid_username&quot;</span><span class="p">,</span>
        <span class="n">sso_email</span><span class="o">=</span><span class="s2">&quot;sso_email@mail.com&quot;</span><span class="p">,</span>
        <span class="n">supress_stderr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Example:                                                                                                        │
│                                                                                                                 │
│     # Importing necessary libraries                                                                             │
│     from  airt.client import Client, User                                                                       │
│                                                                                                                 │
│     # Authenticate                                                                                              │
│     Client.get_token(username="{fill in username}", password="{fill in password}")                              │
│                                                                                                                 │
│     # Enable single sign-on (SSO) and use google as the provider                                                │
│     sso_provider="google"                                                                                       │
│     sso_email="{fill in sso_email}"                                                                             │
│     User.enable_sso(sso_provider=sso_provider, sso_email=sso_email)                                             │
│                                                                                                                 │
│     # Authenticate using Single sign-on (SSO)                                                                   │
│     # To generate a token using SSO, you must first authenticate with the provider.                             │
│     # The command below will generate an authorization URL for you.                                             │
│     # Please copy and paste it into your preferred browser and complete the                                     │
│     # SSO provider authentication within 10 minutes. Otherwise, the SSO login                                   │
│     # will time out and you will need to call the get_token method again.                                       │
│     sso_url = Client.get_token(sso_provider=sso_provider)                                                       │
│     print(sso_url)                                                                                              │
│                                                                                                                 │
│     # Once the provider authentication is successful, call the below method to                                  │
│     # set the generated token                                                                                   │
│     Client.set_sso_token()                                                                                      │
│                                                                                                                 │
│     # If set_sso_token fails, the line below will throw an error.                                               │
│     print(User.details())                                                                                       │
│                                                                                                                 │
│ ╭────────────────────────────────────────────────── stdout ───────────────────────────────────────────────────╮ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
│ ╭───────────────────────────────────────────── stderr supressed ──────────────────────────────────────────────╮ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
</pre>

<div class="highlight"><pre><span></span><code><span class="c1"># Run example for Client.version</span>

<span class="n">run_examples_from_docstring</span><span class="p">(</span>
    <span class="n">Client</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&lt;module&gt;:3: No type or annotation for returned value 1
Failed to parse annotation from &#39;Name&#39; node: &#39;NoneType&#39; object has no attribute &#39;resolve&#39;
</code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Example:                                                                                                        │
│                                                                                                                 │
│     # Importing necessary libraries                                                                             │
│     from  airt.client import Client                                                                             │
│                                                                                                                 │
│     # Get the client and server versions                                                                        │
│     print(Client.version())                                                                                     │
│                                                                                                                 │
│ ╭────────────────────────────────────────────────── stdout ───────────────────────────────────────────────────╮ │
│ │ {'client': '2022.10.0rc0', 'server': '2022.10.0rc0'}                                                        │ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
│ ╭────────────────────────────────────────────────── stderr ───────────────────────────────────────────────────╮ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
</pre>

<div class="highlight"><pre><span></span><code><span class="c1"># Run example for Client.set_token</span>

<span class="n">run_examples_from_docstring</span><span class="p">(</span><span class="n">Client</span><span class="o">.</span><span class="n">set_token</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&lt;module&gt;:8: No type or annotation for parameter &#39;token&#39;
&lt;module&gt;:10: No type or annotation for parameter &#39;server&#39;
</code></pre></div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Example:                                                                                                        │
│                                                                                                                 │
│     # Importing necessary libraries                                                                             │
│     from  airt.client import Client, User                                                                       │
│                                                                                                                 │
│     # Optional Step: For demonstration purpose, generate a new token                                            │
│     # When you generate a new token with the get_token method, you do not                                       │
│     # need to explicitly call set_token. It is shown here for demo purposes only.                               │
│     # Skip this step if you already have a valid token and pass it directly to                                  │
│     # the set_token method below                                                                                │
│     Client.get_token(username="{fill in username}", password="{fill in password}")                              │
│                                                                                                                 │
│     # Setting a valid token                                                                                     │
│     Client.set_token(token=Client.auth_token)                                                                   │
│                                                                                                                 │
│     # If set_token fails, the line below will throw an error.                                                   │
│     print(User.details())                                                                                       │
│                                                                                                                 │
│ ╭────────────────────────────────────────────────── stdout ───────────────────────────────────────────────────╮ │
│ │ {'username': 'johndoe', 'first_name': 'John', 'last_name': 'Doe', 'email': 'johndoe@airt.ai',               │ │
│ │ 'subscription_type': 'small', 'super_user': False, 'phone_number': None, 'uuid':                            │ │
│ │ '7363f72b-7ebb-425c-832f-99c42fb7a016', 'disabled': False, 'created': '2022-10-27T04:39:16',                │ │
│ │ 'is_phone_number_verified': False, 'is_mfa_active': False}                                                  │ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
│ ╭────────────────────────────────────────────────── stderr ───────────────────────────────────────────────────╮ │
│ │                                                                                                             │ │
│ ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────╯ │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
</pre>

<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client._get_server_url_and_token.</span>
<span class="c1"># cls.server is set to None, and the env variable is not set. The public URL should be returned</span>

<span class="c1"># deleting the env variable</span>
<span class="n">_SERVER_URL</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVER_URL</span><span class="p">):</span>
    <span class="n">_SERVER_URL</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVER_URL</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVER_URL</span><span class="p">]</span>

<span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>

<span class="n">expected</span> <span class="o">=</span> <span class="s2">&quot;https://api.airt.ai&quot;</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">server</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">server</span> <span class="o">==</span> <span class="n">expected</span>

<span class="c1"># Assigning the value back to the env variable</span>
<span class="k">if</span> <span class="n">_SERVER_URL</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVER_URL</span><span class="p">]</span> <span class="o">=</span> <span class="n">_SERVER_URL</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;server=&#39;https://api.airt.ai&#39;&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client._get_server_url_and_token.</span>
<span class="c1"># cls.server is set to &quot;http://example-service:6006&quot;, the same should be returned</span>

<span class="n">Client</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="s2">&quot;http://example-service:6006&quot;</span>

<span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>

<span class="n">expected</span> <span class="o">=</span> <span class="s2">&quot;http://example-service:6006&quot;</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">server</span><span class="p">)</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">server</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">server</span> <span class="o">==</span> <span class="n">expected</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;len(server)=27 server=&#39;http://example-service:6006&#39;&quot;

&#39;len(expected)=27&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client._get_server_url_and_token.</span>
<span class="c1"># cls.server is set to None, and getting the server URL from env variable</span>

<span class="n">Client</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>

<span class="n">expected</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVER_URL</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">server</span><span class="p">)</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">server</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">server</span> <span class="o">==</span> <span class="n">expected</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;len(server)=24 server=&#39;http://airt-service:6006&#39;&quot;

&#39;len(expected)=24&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for version</span>

<span class="n">version</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">version</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="p">,</span> <span class="s2">&quot;server&quot;</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>{&#39;client&#39;: &#39;2022.10.0rc0&#39;, &#39;server&#39;: &#39;2022.10.0rc0&#39;}
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.get_token</span>
<span class="c1"># Testing the SSO flow</span>
<span class="c1"># Negative scenario: generating SSO token without enabling the SSO provider</span>
<span class="n">sso_providers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;google&quot;</span><span class="p">,</span> <span class="s2">&quot;github&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">sso_provider</span> <span class="ow">in</span> <span class="n">sso_providers</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s2">&quot;SSO is not enabled&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;SSO is not enabled for the provider.&#39;

&#39;SSO is not enabled for the provider.&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># A helper context manager to create new users for testing</span>
<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">create_normal_user_for_testing</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 1. Get Super user token</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_SUPER_USER</span><span class="p">]</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_PASSWORD</span><span class="p">]</span>

        <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>

        <span class="n">_user_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;random_user_</span><span class="si">{</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">_email</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;random_user_</span><span class="si">{</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="si">}</span><span class="s2">@email.com&quot;</span>
        <span class="n">_password</span> <span class="o">=</span> <span class="s2">&quot;random_password&quot;</span>

        <span class="n">req_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="n">_user_name</span><span class="p">,</span>
            <span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;random_first_name&quot;</span><span class="p">,</span>
            <span class="n">last_name</span><span class="o">=</span><span class="s2">&quot;random_last_name&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="n">_email</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">_password</span><span class="p">,</span>
            <span class="n">super_user</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">subscription_type</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span><span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/&quot;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">req_data</span><span class="p">)</span>

        <span class="n">response_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="n">User</span><span class="o">.</span><span class="n">USER_COLS</span><span class="p">]</span>

        <span class="k">assert</span> <span class="n">response_df</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">USER_COLS</span><span class="p">))</span>

        <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">_user_name</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">_password</span><span class="p">)</span>

        <span class="k">yield</span> <span class="n">_user_name</span><span class="p">,</span> <span class="n">_password</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.get_token</span>
<span class="c1"># Testing the SSO flow</span>
<span class="c1"># Positive scenario: SSO enabled user generating token using non-SSO flow</span>


<span class="k">with</span> <span class="n">create_normal_user_for_testing</span><span class="p">()</span> <span class="k">as</span> <span class="n">credentials</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">sso_email</span> <span class="o">=</span> <span class="s2">&quot;sso_email@mail.com&quot;</span>
    <span class="n">sso_provider</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/sso/enable&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">sso_email</span><span class="o">=</span><span class="n">sso_email</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
    <span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>

    <span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">server</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">mask</span><span class="p">(</span><span class="n">auth_token</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;server=&#39;http://airt-service:6006&#39;, mask(auth_token)=&#39;*************************************************************************************************************************************************&#39;&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.get_token</span>
<span class="c1"># Testing the SSO flow</span>
<span class="c1"># Positive scenario: SSO enabled user generating token using SSO flow</span>


<span class="k">with</span> <span class="n">create_normal_user_for_testing</span><span class="p">()</span> <span class="k">as</span> <span class="n">credentials</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">sso_email</span> <span class="o">=</span> <span class="s2">&quot;random_email@mail.com&quot;</span>
    <span class="n">sso_provider</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/sso/enable&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">sso_email</span><span class="o">=</span><span class="n">sso_email</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">sso_authorization_url</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span>
        <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span>
    <span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">sso_authorization_url</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">sso_authorization_url</span> <span class="o">==</span> <span class="n">Client</span><span class="o">.</span><span class="n">sso_authorization_url</span>
    <span class="k">assert</span> <span class="n">sso_provider</span> <span class="ow">in</span> <span class="n">Client</span><span class="o">.</span><span class="n">sso_authorization_url</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;https://accounts.google.com/o/oauth2/v2/auth?response_type=code&amp;client_id=842138153914-6kvm51cpin7iocg3nrsnl44s3d24u047.apps.googleusercontent.com&amp;redirect_uri=http%3A%2F%2F127.0.0.1%3A6006%2Fsso%2Fcallback&amp;scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+openid&amp;state=113d57e1be6c79c4dbb193654c6872fb0e5e0a903f6daefeccd84f247d0b43d0_random_user_6403_7411&amp;prompt=select_account&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.get_token</span>
<span class="c1"># Testing the SSO flow</span>
<span class="c1"># Positive scenario: SSO enabled user generating token using SSO flow</span>


<span class="k">with</span> <span class="n">create_normal_user_for_testing</span><span class="p">()</span> <span class="k">as</span> <span class="n">credentials</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">sso_email</span> <span class="o">=</span> <span class="s2">&quot;random_email@mail.com&quot;</span>
    <span class="n">sso_provider</span> <span class="o">=</span> <span class="s2">&quot;github&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/sso/enable&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">sso_email</span><span class="o">=</span><span class="n">sso_email</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">sso_authorization_url</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span>
        <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span>
    <span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">sso_authorization_url</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">sso_authorization_url</span> <span class="o">==</span> <span class="n">Client</span><span class="o">.</span><span class="n">sso_authorization_url</span>
    <span class="k">assert</span> <span class="n">sso_provider</span> <span class="ow">in</span> <span class="n">Client</span><span class="o">.</span><span class="n">sso_authorization_url</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;https://github.com/login/oauth/authorize?response_type=code&amp;client_id=a0f58d9e50375190dbf0&amp;redirect_uri=http%3A%2F%2F127.0.0.1%3A6006%2Fsso%2Fcallback&amp;scope=user%3Aemail&amp;state=3847806b1fdfa263921df7c68b70ba4eb15e15283bb5b341f4a3387d33d018d9_random_user_7488_1316&amp;prompt=select_account&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.get_token</span>
<span class="c1"># Testing the SSO flow</span>
<span class="c1"># Negative scenario: Non-MFA user passing OTP while intiating SSO flow</span>

<span class="k">with</span> <span class="n">create_normal_user_for_testing</span><span class="p">()</span> <span class="k">as</span> <span class="n">credentials</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">sso_email</span> <span class="o">=</span> <span class="s2">&quot;random_user@gmail.com&quot;</span>
    <span class="n">sso_provider</span> <span class="o">=</span> <span class="s2">&quot;github&quot;</span>
    <span class="n">random_otp</span> <span class="o">=</span> <span class="s2">&quot;123456&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/sso/enable&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">sso_email</span><span class="o">=</span><span class="n">sso_email</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="n">random_otp</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s2">&quot;Incorrect username or password&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;Incorrect username or password. Please try again.&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.get_token</span>
<span class="c1"># Testing the SSO flow</span>
<span class="c1"># Negative scenario: Generating token for wrong sso_provider</span>


<span class="k">with</span> <span class="n">create_normal_user_for_testing</span><span class="p">()</span> <span class="k">as</span> <span class="n">credentials</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">sso_email</span> <span class="o">=</span> <span class="s2">&quot;random_user@gmail.com&quot;</span>
    <span class="n">sso_provider</span> <span class="o">=</span> <span class="s2">&quot;github&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/sso/enable&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">sso_email</span><span class="o">=</span><span class="n">sso_email</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s2">&quot;SSO is not enabled&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;SSO is not enabled for the provider.&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.get_token</span>
<span class="c1"># Testing the SSO flow</span>
<span class="c1"># Negative scenario: Generating token for invalid sso_provider</span>


<span class="k">with</span> <span class="n">create_normal_user_for_testing</span><span class="p">()</span> <span class="k">as</span> <span class="n">credentials</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">sso_email</span> <span class="o">=</span> <span class="s2">&quot;random_user@gmail.com&quot;</span>
    <span class="n">sso_provider</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span>
    <span class="n">invalid_sso_provider</span> <span class="o">=</span> <span class="s2">&quot;invalid_sso_provider&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/sso/enable&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">sso_email</span><span class="o">=</span><span class="n">sso_email</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">invalid_sso_provider</span><span class="p">)</span>
<span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;Invalid SSO provider. Valid SSO providers are: [&#39;google&#39;, &#39;github&#39;]&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client.set_sso_token</span>
<span class="c1"># Negative scenario: Trying to set sso token without completing the SSO authentication</span>

<span class="k">with</span> <span class="n">create_normal_user_for_testing</span><span class="p">()</span> <span class="k">as</span> <span class="n">credentials</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">sso_email</span> <span class="o">=</span> <span class="s2">&quot;random_email@mail.com&quot;</span>
    <span class="n">sso_provider</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/user/sso/enable&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span><span class="p">,</span> <span class="n">sso_email</span><span class="o">=</span><span class="n">sso_email</span><span class="p">,</span> <span class="n">otp</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">sso_authorization_url</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span>
        <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">sso_provider</span><span class="o">=</span><span class="n">sso_provider</span>
    <span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">sso_authorization_url</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">sso_authorization_url</span> <span class="o">==</span> <span class="n">Client</span><span class="o">.</span><span class="n">sso_authorization_url</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">Client</span><span class="o">.</span><span class="n">set_sso_token</span><span class="p">()</span>

    <span class="n">err</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s2">&quot;SSO authentication is not complete&quot;</span> <span class="ow">in</span> <span class="n">err</span>
    <span class="n">display</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;https://accounts.google.com/o/oauth2/v2/auth?response_type=code&amp;client_id=842138153914-6kvm51cpin7iocg3nrsnl44s3d24u047.apps.googleusercontent.com&amp;redirect_uri=http%3A%2F%2F127.0.0.1%3A6006%2Fsso%2Fcallback&amp;scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+openid&amp;state=6466e1741b7841f6176fb9630f551bf965d9b1467b84a7714aa30364138fa7a1_random_user_1211_1669&amp;prompt=select_account&#39;

&#39;SSO authentication is not complete. Please click on the authentication link you have received while requesting a new token and complete the login process first.&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client</span>
<span class="c1"># Checking positive scenario. Read both username and password from the environment variables</span>
<span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">()</span>
<span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">server</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">mask</span><span class="p">(</span><span class="n">auth_token</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">server</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVER_URL</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">auth_token</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">127</span>  <span class="c1"># maybe</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;server=&#39;http://airt-service:6006&#39;, mask(auth_token)=&#39;*******************************************************************************************************************************&#39;&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client</span>
<span class="c1"># Checking positive scenario. Passing all the required parameters in arguments</span>

<span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_USERNAME</span><span class="p">]</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_PASSWORD</span><span class="p">]</span>

<span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>

<span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">server</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">mask</span><span class="p">(</span><span class="n">auth_token</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">server</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVER_URL</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">auth_token</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">127</span>  <span class="c1"># maybe</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;server=&#39;http://airt-service:6006&#39;, mask(auth_token)=&#39;*******************************************************************************************************************************&#39;&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Tests for Client</span>
<span class="c1"># Checking negative scenario. Passing wrong username and password combination</span>

<span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;randomUser&quot;</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;whatever&quot;</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;Incorrect username or password&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;e.value=ValueError(&#39;Incorrect username or password. Please try again.&#39;)&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test cases for Client._get_data</span>
<span class="c1"># Checking positive scenario.</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span><span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/version&quot;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">response</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&quot;airt_service&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;response={&#39;airt_service&#39;: &#39;2022.10.0rc0&#39;}&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test cases for Client._delete_data</span>


<span class="k">def</span> <span class="nf">create_and_return_test_db_id</span><span class="p">():</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;s3://test-airt-service/account_312571_events_csv&quot;</span>
    <span class="n">access_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AWS_ACCESS_KEY_ID&quot;</span><span class="p">]</span>
    <span class="n">secret_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AWS_SECRET_ACCESS_KEY&quot;</span><span class="p">]</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_post_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="s2">&quot;/datablob/from_s3&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="n">uri</span><span class="p">,</span> <span class="n">access_key</span><span class="o">=</span><span class="n">access_key</span><span class="p">,</span> <span class="n">secret_key</span><span class="o">=</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">]</span>


<span class="n">db_id</span> <span class="o">=</span> <span class="n">create_and_return_test_db_id</span><span class="p">()</span>

<span class="c1"># Deleting the sample datablob</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_delete_data</span><span class="p">(</span><span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/datablob/</span><span class="si">{</span><span class="n">db_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">db_id</span>

<span class="c1"># Negative scenario. Trying to delete already deleted data source</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">Client</span><span class="o">.</span><span class="n">_delete_data</span><span class="p">(</span><span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/datablob/</span><span class="si">{</span><span class="n">db_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;\ne.value=ValueError(&#39;The datablob has already been deleted.&#39;)&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test cases for Client.set_token</span>
<span class="c1"># Negative case: The token is not passed as parameter nor set in SERVICE_TOKEN</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">Client</span><span class="o">.</span><span class="n">set_token</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;&#39;The token is neither passed as parameter nor set in the environment variable </span><span class="si">{</span><span class="n">SERVICE_TOKEN</span><span class="si">}</span><span class="s2">.&#39;&quot;</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;str(e.value)=&quot;\&#39;The token is neither passed as parameter nor set in the environment variable AIRT_SERVICE_TOKEN.\&#39;&quot;&#39;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test cases for Client.set_token</span>
<span class="c1"># Positive case: Setting valid token in SERVICE_TOKEN env variable and accessing the API</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_TOKEN</span><span class="p">]</span> <span class="o">=</span> <span class="n">auth_token</span>

<span class="n">Client</span><span class="o">.</span><span class="n">set_token</span><span class="p">()</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span>
    <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/datablob/?disabled=false&amp;completed=false&amp;offset=0&amp;limit=100&quot;</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>

<span class="c1"># Deleting the env variable</span>
<span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">SERVICE_TOKEN</span><span class="p">]</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">SERVICE_TOKEN</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;type(response)=&lt;class &#39;list&#39;&gt;&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test cases for Client.set_token</span>
<span class="c1"># Positive case: Setting token and server using Client.set_token and asserting the same using Client._get_server_url_and_token</span>

<span class="n">fake_token</span> <span class="o">=</span> <span class="s2">&quot;fake-token&quot;</span>
<span class="n">fake_server</span> <span class="o">=</span> <span class="s2">&quot;http://fake-server&quot;</span>

<span class="n">Client</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="n">fake_token</span><span class="p">,</span> <span class="n">fake_server</span><span class="p">)</span>

<span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">server</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">auth_token</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">fake_server</span><span class="p">,</span> <span class="n">fake_token</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;server=&#39;http://fake-server&#39;, auth_token=&#39;fake-token&#39;&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test cases for Client.set_token</span>
<span class="c1"># Negative case: Setting invalid token and accessing the API</span>

<span class="n">Client</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="n">fake_token</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">Client</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span>
        <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/datablob/?disabled=false&amp;completed=false&amp;offset=0&amp;limit=100&quot;</span>
    <span class="p">)</span>


<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;str(e.value)=&#39;Your credentials could not be validated. The developer token/apikey is invalid or expired.&#39;&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Test cases for Client.set_token</span>
<span class="c1"># Positive case: Setting valid token and accessing the API</span>

<span class="n">Client</span><span class="o">.</span><span class="n">get_token</span><span class="p">()</span>
<span class="n">server</span><span class="p">,</span> <span class="n">auth_token</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_server_url_and_token</span><span class="p">()</span>

<span class="n">Client</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="n">auth_token</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span>
    <span class="n">relative_url</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;/datablob/?disabled=false&amp;completed=false&amp;offset=0&amp;limit=100&quot;</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&quot;type(response)=&lt;class &#39;list&#39;&gt;&quot;
</code></pre></div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2022 onwards, airt.ai
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
    and 
    <a href="https://nbdev-mkdocs.airt.ai/" target="_blank" rel="noopener">
      Material for nbdev
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../overrides/js/extra.js"></script>
        
      
        
          <script src="../overrides/js/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>